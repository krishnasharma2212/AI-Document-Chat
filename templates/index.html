<html lang="en">

<head>
    <!-- Required Meta Tags Always Come First -->
    <meta charset="utf-8">
    <meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


    <!-- Title -->
    <title>Chat - AI Document Chat</title>


    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">

    <!-- Theme Check and Update -->
    <script>

        const html = document.querySelector('html');
        if (localStorage.getItem('hs_theme') == null) {
            localStorage.setItem('hs_theme', "dark")
        }
        const isLightOrAuto = localStorage.getItem('hs_theme') === 'light' || (localStorage.getItem('hs_theme') === 'auto' && !window.matchMedia('(prefers-color-scheme: dark)').matches);
        const isDarkOrAuto = localStorage.getItem('hs_theme') === 'dark' || (localStorage.getItem('hs_theme') === 'auto' && window.matchMedia('(prefers-color-scheme: dark)').matches);

        if (isLightOrAuto && html.classList.contains('dark')) html.classList.remove('dark');
        else if (isDarkOrAuto && html.classList.contains('light')) html.classList.remove('light');
        else if (isDarkOrAuto && !html.classList.contains('dark')) html.classList.add('dark');
        else if (isLightOrAuto && !html.classList.contains('light')) html.classList.add('light');

        function toggleTheme() {
            const moon = document.getElementById('moon')
            const sun = document.getElementById('sun')
            const themetext = document.getElementById('themetext')
            if (localStorage.getItem('hs_theme') === 'light') {
                localStorage.setItem('hs_theme', "dark")
                themetext.innerText = "Light"
                sun.style.display = 'block'
                moon.style.display = 'none'
            } else {
                localStorage.setItem('hs_theme', "light")
                themetext.innerText = "Dark"
                sun.style.display = 'none'
                moon.style.display = 'block'

            }
            const isLightOrAuto = localStorage.getItem('hs_theme') === 'light' || (localStorage.getItem('hs_theme') === 'auto' && !window.matchMedia('(prefers-color-scheme: dark)').matches);
            const isDarkOrAuto = localStorage.getItem('hs_theme') === 'dark' || (localStorage.getItem('hs_theme') === 'auto' && window.matchMedia('(prefers-color-scheme: dark)').matches);

            if (isLightOrAuto && html.classList.contains('dark')) html.classList.remove('dark');
            else if (isDarkOrAuto && html.classList.contains('light')) html.classList.remove('light');
            else if (isDarkOrAuto && !html.classList.contains('dark')) html.classList.add('dark');
            else if (isLightOrAuto && !html.classList.contains('light')) html.classList.add('light');


        }
    </script>

    <style>
        .prism-toolbar .toolbar-item {
            cursor: pointer;
            color: #FFF;
            background-color: #333;
            padding: 0.2rem 0.6rem;
            border-radius: 0.3rem;
            transition: background-color 0.3s ease;
        }

        .prism-toolbar .toolbar-item:hover {
            background-color: #555;
        }

        code:not(.language-markup):not(.language-js)::before,
        code:not(.language-markup):not(.language-js)::after {
            content: "" !important;
        }

        /* Custom animation for toast appearance */
        @keyframes slideDown {
            0% {
                transform: translateY(-100%);
                opacity: 0;
            }

            100% {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .toast-show {
            animation: slideDown 0.5s ease-in-out forwards;
        }

        /* Add these styles to ensure the toast is visible */
        #toast {
            position: fixed;
            /* Make it fixed so it stays at the top */
            top: 20px;
            /* Adjust this to control how far from the top the toast appears */
            left: 50%;
            transform: translateX(-50%);
            /* Center it horizontally */
            z-index: 1000;
            /* Ensure it's above other elements */
            opacity: 0;
            /* Start hidden */
            pointer-events: none;
            /* Prevent interaction until shown */
        }

        /* Apply custom scrollbar styles to all scrollable elements */
        *::-webkit-scrollbar {
            width: 8px;
            /* Set the width of the scrollbar */
            height: 8px;
            /* Set the height of the scrollbar for horizontal scroll */
        }

        *::-webkit-scrollbar-thumb {
            background-color: #3b3b3b;
            /* Color of the scrollbar thumb */
            border-radius: 10px;
            /* Rounded corners for the scrollbar thumb */
        }

        *::-webkit-scrollbar-track {
            background: transparent;
            /* Background color of the scrollbar track */
        }

        * {
            scrollbar-width: thin;
            /* For Firefox: Set the scrollbar width to thin */
            scrollbar-color: #414141 transparent;
            /* For Firefox: Set the scrollbar thumb and track color */
        }

        #logo-sidebar {

            transition: margin-left 0.5s ease;
        }

        .toolbar {
            opacity: 1 !important;
            display: block !important;
        }
    </style>

    <!-- CSS HS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='tailwind.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='prism.css') }}">
</head>

<body class="dark:bg-neutral-900" data-prismjs-copy-timeout="500" style="overflow-y: hidden;">
    <audio src="" id="player"></audio>

    <!-- Toast notification element -->
    <div id="toast"
        class="fixed top-4 left-1/2 transform -translate-x-1/2 bg-blue-600 text-white px-4 py-2 rounded shadow-lg opacity-0 pointer-events-none">
        Text Copied!
    </div>

    <nav
        class="fixed top-0 z-50 w-full bg-white border-b border-gray-200 bg-white dark:bg-neutral-900 dark:border-neutral-700">
        <div class="px-3 py-3 lg:px-5 lg:pl-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center justify-start rtl:justify-end">
                    <button data-drawer-target="logo-sidebar" data-drawer-toggle="logo-sidebar" onclick="toggleNav();"
                        aria-controls="logo-sidebar" type="button"
                        class="inline-flex items-center p-2 text-sm rounded-lg  focus:outline-none focus:ring-2 focus:ring-gray-200 bg-neutral-900 text-white hover:bg-neutral-950 disabled:opacity-50 disabled:pointer-events-none focus:outline-none focus:bg-neutral-900 dark:bg-neutral-800 dark:hover:bg-neutral-700 dark:focus:bg-neutral-700">
                        <span class="sr-only">Open sidebar</span>
                        <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20"
                            xmlns="http://www.w3.org/2000/svg">
                            <path clip-rule="evenodd" fill-rule="evenodd"
                                d="M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zm0 10.5a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5a.75.75 0 01-.75-.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10z">
                            </path>
                        </svg>
                    </button>
                    <a href="/" class="flex ms-2 md:me-24">
                        <img src="{{ url_for('static', filename='logo.jpg') }}" class="h-8 me-3" alt="Logo" />
                        <span
                            class="self-center text-xl font-semibold sm:text-2xl whitespace-nowrap dark:text-white">AI Chat Document</span>
                    </a>
                </div>
                <div class="flex items-center">
                    <div class="flex items-center ms-3">
                        <div>
                            <button type="button" onclick="toggleUser();"
                                class="flex text-sm bg-gray-800 rounded-full focus:ring-4 focus:ring-gray-300 dark:focus:ring-gray-600"
                                aria-expanded="false" data-dropdown-toggle="dropdown-user">
                                <span class="sr-only">Open user menu</span>
                                <span
                                    class="shrink-0 inline-flex items-center justify-center size-[38px] rounded-full bg-green-600">
                                    <span class="text-sm font-medium text-white leading-none">{{icon}}</span>
                                </span>
                            </button>
                        </div>
                        <div class="z-50 hidden  my-4 text-base list-none bg-white dark:bg-neutral-900 divide-y divide-gray-100 rounded shadow dark:bg-gray-700 dark:divide-gray-600"
                            id="dropdown-user" style="position: fixed;right: 10;top: 50;">
                            <div class="px-4 py-3" role="none">
                                <p class="text-sm dark:text-white" role="none">
                                    {{name}}
                                </p>
                                <p class="text-sm font-medium truncate dark:text-blue-500" role="none">
                                    {{email}}
                                </p>
                            </div>
                            <ul class="py-1" role="none">

                                <li>
                                    <a href="/logout"
                                        class="block px-4 py-2 text-sm rounded-lg group bg-white text-gray-800 shadow-sm hover:bg-gray-50 focus:outline-none focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-800 dark:focus:bg-neutral-800"
                                        role="menuitem">Log out</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <aside id="logo-sidebar"
        class="fixed top-0 shadow-xl left-0 z-40 w-64 h-screen pt-20 transition-transform -translate-x-full sm:translate-x-0 bg-white border border-gray-200 dark:bg-neutral-900 dark:border-neutral-700"
        aria-label="Sidebar">
        <div
            class="flex flex-col justify-between h-full max-w-md mx-auto px-3 pb-4 overflow-y-auto bg-white border border-gray-200 dark:bg-neutral-900 dark:border-neutral-700">

            <!-- <div class=""> -->

            <div class="mt-3">
                <span class="text-xs text-white dark:text-gray-200 bg-blue-500 dark:bg-blue-700 py-1 px-2 rounded">
                    Chats
                </span>

                <ul class="space-y-2 font-medium mt-2" id="history">
                   

                </ul>
            </div>

            <ul class="space-y-2 font-medium">
                <li>
                    <a href="#" onclick="toggleTheme()"
                        class="flex items-center p-2 rounded-lg  group bg-white text-gray-800 shadow-sm hover:bg-gray-50 focus:outline-none focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-800 dark:focus:bg-neutral-800">
                        <svg id="sun"
                            class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white"
                            xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                            class="bi bi-sun" viewBox="0 0 16 16">
                            <path
                                d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6m0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0m9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708" />
                        </svg>
                        <svg id="moon" style="display: none;"
                            class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white"
                            xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                            class="bi bi-sun" viewBox="0 0 16 16">
                            <path
                                d="M6 .278a.77.77 0 0 1 .08.858 7.2 7.2 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277q.792-.001 1.533-.16a.79.79 0 0 1 .81.316.73.73 0 0 1-.031.893A8.35 8.35 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.75.75 0 0 1 6 .278M4.858 1.311A7.27 7.27 0 0 0 1.025 7.71c0 4.02 3.279 7.276 7.319 7.276a7.32 7.32 0 0 0 5.205-2.162q-.506.063-1.029.063c-4.61 0-8.343-3.714-8.343-8.29 0-1.167.242-2.278.681-3.286" />
                        </svg>
                        <span class="flex-1 ms-3 whitespace-nowrap" id="themetext">Light</span>
                    </a>
                </li>
                <li>
                    <a href="/logout"
                        class="flex items-center p-2 rounded-lg  group bg-white text-gray-800 shadow-sm hover:bg-gray-50 focus:outline-none focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-800 dark:focus:bg-neutral-800">
                        <svg class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white"
                            aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 18 16">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M1 8h11m0 0L8 4m4 4-4 4m4-11h3a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-3" />
                        </svg>
                        <span class="flex-1 ms-3 whitespace-nowrap">Logout</span>
                    </a>
                </li>

            </ul>

        </div>
    </aside>


    <main id="content">
        <!-- Content -->

        <div class="relative h-screen">

            <div class="max-w-4xl px-4 py-10 sm:px-6 lg:px-8 lg:py-14 mx-auto h-full" id="chatBox"
                style="overflow-y: auto;">
                <!-- Title -->
                <div class="text-center mt-10">
                    <a class="inline-block mb-4 flex-none focus:outline-none focus:opacity-80" href="#"
                        aria-label="Preline">
                        <img src="{{ url_for('static', filename='logo.jpg') }}" class="rounded-full w-20" alt="">
                    </a>

                    <h1 class="text-3xl font-bold text-gray-800 sm:text-4xl dark:text-white">
                        Welcome to AI Document Chat
                    </h1>
                    <p class="mt-3 text-gray-600 dark:text-neutral-400">
                        Your AI-powered copilot for the web
                    </p>
                </div>
                <!-- End Title -->

                <ul class="mt-16 space-y-5" id="chats" style="margin-bottom: 150px;">


                </ul>

            </div>

            <div
                class="max-w-4xl mx-auto sticky bottom-0 z-10 bg-white border-t border-gray-200 pt-2 pb-4 sm:pt-4 sm:pb-6 px-4 sm:px-6 lg:px-0 dark:bg-neutral-900 dark:border-neutral-700">
                <!-- Textarea -->
                <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="flex justify-between items-center mb-3" style="overflow-x: auto;">
                        <button type="button" onclick="window.location = '/'"
                            class="inline-flex justify-center items-center gap-x-2 rounded-lg font-medium text-gray-800 hover:text-blue-600 focus:outline-none focus:text-blue-600 text-xs sm:text-sm dark:text-neutral-200 dark:hover:text-blue-500 dark:focus:text-blue-500">
                            <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round">
                                <path d="M5 12h14"></path>
                                <path d="M12 5v14"></path>
                            </svg>
                            New chat
                        </button>


                        <div class="flex gap-x-2" id="upload">

                        </div>

                        <button type="button" onclick="this.style.display='none';isRunning=false" id="stop"
                            style="display: none;"
                            class="py-1.5 px-2 inline-flex items-center gap-x-2 text-xs font-medium rounded-lg border border-gray-200 bg-white text-gray-800 shadow-sm hover:bg-gray-50 focus:outline-none focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-800 dark:focus:bg-neutral-800">
                            <svg class="size-3" xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                fill="currentColor" viewBox="0 0 16 16">
                                <path
                                    d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5z">
                                </path>
                            </svg>
                            Stop generating
                        </button>

                    </div>

                    <!-- Input -->
                    <div class="relative">
                        <textarea id="prompt"
                            class="p-4 pb-12 block w-full border-gray-200 rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-400 dark:placeholder-neutral-500 dark:focus:ring-neutral-600"
                            placeholder="Ask me anything..."></textarea>

                        <!-- Toolbar -->
                        <div class="absolute bottom-px inset-x-px p-2 rounded-b-lg bg-white dark:bg-neutral-900">
                            <div class="flex justify-between items-center">
                                <!-- Button Group -->
                                <div class="flex items-center">
                                    <input type="file" id="fileInput" multiple style="display: none;">

                                    <!-- Attach Button -->
                                    <button type="button"
                                        class="inline-flex shrink-0 justify-center items-center size-8 rounded-lg text-gray-500 hover:bg-gray-100 focus:z-10 focus:outline-none focus:bg-gray-100 dark:text-neutral-500 dark:hover:bg-neutral-700 dark:focus:bg-neutral-700"
                                        onclick="document.getElementById('fileInput').click()">
                                        <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24"
                                            height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path
                                                d="m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48">
                                            </path>
                                        </svg>
                                    </button>
                                    <!-- End Attach Button -->
                                </div>
                                <!-- End Button Group -->

                                <!-- Button Group -->
                                <div class="flex items-center gap-x-1">
                                    <!-- Mic Button -->

                                    <button type="button"
                                        class="inline-flex shrink-0 justify-center items-center size-8 rounded-lg text-gray-500 hover:bg-gray-100 focus:z-10 focus:outline-none focus:bg-gray-100 dark:text-neutral-500 dark:hover:bg-neutral-700 dark:focus:bg-neutral-700"
                                        onclick="startRecording()" id="mic">
                                        <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24"
                                            id="play" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path>
                                            <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                                            <line x1="12" x2="12" y1="19" y2="22"></line>
                                        </svg>
                                        <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 size-4" width="24"
                                            height="24" fill="red" class="bi bi-stop" viewBox="0 0 16 16" id="stopMic"
                                            style="display: none;">
                                            <path
                                                d="M3.5 5A1.5 1.5 0 0 1 5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11zM5 4.5a.5.5 0 0 0-.5.5v6a.5.5 0 0 0 .5.5h6a.5.5 0 0 0 .5-.5V5a.5.5 0 0 0-.5-.5z" />
                                        </svg>
                                    </button>
                                    <!-- End Mic Button -->

                                    <!-- Send Button -->
                                    <button type="button" onclick="send();"
                                        class="inline-flex shrink-0 justify-center items-center size-8 rounded-lg text-white bg-blue-600 hover:bg-blue-500 focus:z-10 focus:outline-none focus:bg-blue-500">
                                        <svg class="shrink-0 size-3.5" xmlns="http://www.w3.org/2000/svg" width="16"
                                            height="16" fill="currentColor" viewBox="0 0 16 16">
                                            <path
                                                d="M15.964.686a.5.5 0 0 0-.65-.65L.767 5.855H.766l-.452.18a.5.5 0 0 0-.082.887l.41.26.001.002 4.995 3.178 3.178 4.995.002.002.26.41a.5.5 0 0 0 .886-.083l6-15Zm-1.833 1.89L6.637 10.07l-.215-.338a.5.5 0 0 0-.154-.154l-.338-.215 7.494-7.494 1.178-.471-.47 1.178Z">
                                            </path>
                                        </svg>
                                    </button>
                                    <!-- End Send Button -->
                                </div>
                                <!-- End Button Group -->
                            </div>
                        </div>
                        <!-- End Toolbar -->
                    </div>
                    <!-- End Input -->

                </div>
                <!-- End Textarea -->
            </div>
        </div>
        <!-- End Content -->
    </main>
    <!-- ========== END MAIN CONTENT ========== -->




    <script src="{{ url_for('static', filename='prism.js') }}"></script>
    <script src="{{ url_for('static', filename='custom.js') }}"></script>

    <script>
        const chatsData = {{ chat | safe}}
        i = 0
        chatsData.forEach(element => {
            i += 1
            const prompt = document.getElementById('prompt')
            const chats = document.getElementById('chats')

            const UserINP = element['parts'].join()


            if (element['role'] == "user") {
                let fileNames = element['file']
                let FileRaw = `<ul class="flex flex-col justify-end text-start -space-y-px">`

                // Populate the file list
                if (fileNames) {
                    fileNames.forEach((fileName) => {
                        FileRaw += `
                        <li
                            class="flex items-center gap-x-2 p-3 text-sm bg-white border text-gray-800 first:rounded-t-lg first:mt-0 last:rounded-b-lg dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200">
                            <div class="w-full flex justify-between truncate">
                                <span class="me-3 flex-1 w-0 truncate">
                                    ${fileName}
                                </span>
                            
                            </div>
                        </li>`



                        // removeBtn.dataset.fileIndex = fileName;


                    });
                }
                FileRaw += "</ul>"



                const li = document.createElement('li');

                // Add the classes to the li element
                li.classList.add('max-w-2xl', 'ms-auto', 'flex', 'justify-end', 'gap-x-2', 'sm:gap-x-4');

                const raw = `         <div class="grow text-end space-y-3">
                    <!-- Card -->
                    <div class="inline-block bg-blue-600 rounded-lg p-4 shadow-sm">
                        <p class="text-sm text-white">
                        ${UserINP}
                        </p>
                        </div>
                        ${FileRaw}              
                    <!-- End Card -->
                </div>

                <span
                    class="shrink-0 inline-flex items-center justify-center size-[38px] rounded-full bg-gray-600">
                    <span class="text-sm font-medium text-white leading-none">UK</span>
                </span>`

                li.innerHTML = raw;

                chats.appendChild(li);


            } else {
                const liAI = document.createElement('li');

                // Add the classes to the li element
                liAI.classList.add('flex', 'gap-x-2', 'sm:gap-x-4');
                i += 1
                const rawAI = `
<img src="{{ url_for('static', filename='logo.jpg') }}" class="rounded-full" alt="" style="
width: 38px;
height: 38px;
">

<div class="grow max-w-[90%] md:max-w-2xl w-full space-y-3">
<!-- Card -->
<div class="bg-white border border-gray-200 rounded-lg p-4 space-y-3 dark:bg-neutral-900 dark:border-neutral-700">
    <span class="text-gray-800 dark:text-white" style="white-space: pre-wrap;" id="AI-${i}"></span>
    <code style="display:none;white-space: pre-wrap;" id="AI-copy-${i}" ></code>
</div>
<!-- End Card -->



<div>
    <div class="sm:flex sm:justify-between">
        <div>
            
            <button type="button" class="py-2 px-3 inline-flex items-center gap-x-2 text-sm rounded-full border border-transparent text-gray-500 hover:bg-gray-50 focus:outline-none focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:text-neutral-400 dark:hover:bg-neutral-800 dark:focus:bg-neutral-800" onclick="copy('AI-copy-${i}')">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-copy" viewBox="0 0 16 16">
<path fill-rule="evenodd" d="M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1h1v1a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1v1z"></path>
</svg>
                Copy
            </button>
            
        </div>

        <div class="mt-1 sm:mt-0">
            <button type="button" class="py-2 px-3 inline-flex items-center gap-x-2 text-sm rounded-full border border-transparent text-gray-500 hover:bg-gray-50 focus:outline-none focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:text-neutral-400 dark:hover:bg-neutral-800 dark:focus:bg-neutral-800" onclick="send('${UserINP}')">
                <svg class="size-3.5" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z">
                    </path>
                    <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z">
                    </path>
                </svg>
                New answer
            </button>
        </div>
    </div>
</div>

`
                liAI.innerHTML = rawAI
                chats.append(liAI)


                document.getElementById(`AI-${i}`).innerHTML = formatCodeForPrism(UserINP);
                document.getElementById(`AI-copy-${i}`).innerHTML = UserINP


                


                
            }

        });
        scrollToBottom();
                Prism.highlightAll();

        var isOpen = true;
        function toggleUser() {
            isOpen = !isOpen

            document.getElementById('dropdown-user').classList.toggle("hidden", isOpen);

        }


        const history = document.getElementById('history')
        const allChats = {{allChat | safe}}

        raw = ""
        allChats.forEach(element => {
            
            raw += `<li class="relative group">
                            <a href="/?chat=${element[0]}"
                                class="flex items-center p-2 rounded-lg group bg-white text-gray-800 shadow-sm hover:bg-gray-50 focus:outline-none focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-800 dark:focus:bg-neutral-800">
    
                                <span class="flex-1 ms-3 whitespace-nowrap overflow-hidden overflow-ellipsis"
                                    style="font-size: 14px;">${element[1]}</span>
    
                            </a>
                        </li>`
        });
        history.innerHTML = raw
    </script>







</body>

</html>